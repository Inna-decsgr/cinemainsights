# CinemaInsights

### í”„ë¡œì íŠ¸ ì´ë¦„
cinemainsights

### í”„ë¡œì íŠ¸ ì„¤ëª…
'cinemainsights'ëŠ” ë‹¤ì–‘í•œ ì˜í™” ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” Vue.js ê¸°ë°˜ì˜ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤. ì‚¬ìš©ìëŠ” ì‹¤ì‹œê°„ ì¸ê¸° ì˜í™”, ìµœì‹  ì˜í™”, ì¥ë¥´ë³„ ì˜í™” ë“±ì„ ê²€ìƒ‰í•˜ê³ , ì˜í™”ì— ëŒ€í•œ ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, ì‚¬ìš©ì ë§ì¶¤í˜• ì˜í™” ì¶”ì²œ ê¸°ëŠ¥ë„ ì œê³µëœë‹¤. ì´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ Vue.jsë¡œ êµ¬ì„±ëœ í”„ë¡ íŠ¸ì—”ë“œì™€ MongoDBë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ë°±ì—”ë“œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.

### í”„ë¡œì íŠ¸ ëª©í‘œ
'cinemainsights'ëŠ” ì•„ë˜ì™€ ê°™ì€ ëª©í‘œë¥¼ ê°€ì§€ê³  ê°œë°œë˜ì—ˆë‹¤.
1. **í¬ê´„ì ì¸ ì˜í™” ì •ë³´ ì œê³µ** : ìµœì‹  ì˜í™”, ì¸ê¸° ì˜í™”, ë‹¤ì–‘í•œ ì¥ë¥´ì˜ ì˜í™”ë¥¼ ì‰½ê²Œ ê²€ìƒ‰í•˜ê³  íƒìƒ‰í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
2. **ê°œì¸í™”ëœ ì‚¬ìš©ì ê²½í—˜** : ì‚¬ìš©ì ë§ì¶¤í˜• ì˜í™” ì¶”ì²œ ê¸°ëŠ¥ì„ í†µí•´ ê°œì¸ì˜ ì·¨í–¥ì— ë§ëŠ” ì˜í™”ë¥¼ ì¶”ì²œí•œë‹¤.
3. **ë¦¬ë·° ë° ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥** : ì‚¬ìš©ìê°€ ì˜í™”ì— ëŒ€í•œ ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ê³ , ì¢‹ì•„í•˜ëŠ” ì˜í™”ë¥¼ ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í•˜ì—¬ ê°œì¸í™”ëœ ì˜í™” ëª©ë¡ì„ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤.
4. **íš¨ìœ¨ì ì¸ ìƒíƒœ ê´€ë¦¬** : Vuexë¥¼ í™œìš©í•´ì„œ ì‚¬ìš©ì ì¸ì¦ ìƒíƒœ, ì˜í™” ë°ì´í„°, ê²€ìƒ‰ ê²°ê³¼ ë“±ì˜ ìƒíƒœë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.
5. **ëª¨ë˜ ì›¹ ê¸°ìˆ  í™œìš©** : ìµœì‹  ì›¹ ê¸°ìˆ ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬(vue.js, firebase) í™œìš©ì„ í†µí•´ ì‚¬ìš©ìì—ê²Œ ë§¤ë„ëŸ½ê³  ì§ê´€ì ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤.

### ì‚¬ìš© ê¸°ìˆ 
* **Node.js**: ì„œë²„ ì‚¬ì´ë“œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëŸ°íƒ€ì„
* **Express.js**: Node.jsë¥¼ ìœ„í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬
* **MongoDB**: NoSQL ë°ì´í„°ë² ì´ìŠ¤.
* **Mongoose**: MongoDBì™€ì˜ ì—°ê²°ì„ ìœ„í•œ ODM(Object Data Modeling) ë¼ì´ë¸ŒëŸ¬ë¦¬
* **Axios**: HTTP ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•œ Promise ê¸°ë°˜ì˜ HTTP í´ë¼ì´ì–¸íŠ¸
* **jsonwebtoken**: JSON Web Tokensì„ ì‚¬ìš©í•œ ì¸ì¦ ì²˜ë¦¬
* **dotenv**: í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬.
* **cors**: Cross-Origin Resource Sharing(CORS) ì²˜ë¦¬

### êµ¬í˜„ ì‚¬í•­
* **ì‚¬ìš©ì ê´€ë¦¬** :
  * ì‚¬ìš©ì ë“±ë¡ ë° ì •ë³´ ì €ì¥
  * ì‚¬ìš©ìì— ëŒ€í•œ ì¦ê²¨ì°¾ê¸° ë° ì°œ ê¸°ëŠ¥ êµ¬í˜„
* **ì˜í™” ê´€ë¦¬** :
  * ì¸ê¸° ì˜í™”, ìµœì‹  ì˜í™”, ì¥ë¥´ë³„ ì˜í™” ì •ë³´ ì œê³µ
  * ì˜í™” ê²€ìƒ‰ ë° ìƒì„¸ ì •ë³´ ì œê³µ
* **ì¶”ì²œ ì‹œìŠ¤í…œ** :
  * ì‚¬ìš©ì ê¸°ë°˜ì˜ ì¶”ì²œ ì˜í™” ì‹œìŠ¤í…œ
  * ì¥ë¥´ ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ
* **ë¦¬ë·° ê´€ë¦¬** :
  * ì˜í™”ì— ëŒ€í•œ ë¦¬ë·° ì¶”ê°€, ì¡°íšŒ, ì—…ë°ì´íŠ¸, ì‚­ì œ ê¸°ëŠ¥ ì œê³µ
* **ë³´í˜¸ëœ ë¼ìš°íŠ¸** :
  * JWT(Json Web Token) ì¸ì¦ì„ ì‚¬ìš©í•´ì„œ ë³´í˜¸ëœ API ì—”ë“œí¬ì¸íŠ¸ ì œê³µ
 
### ì£¼ìš” ë‚´ìš©
**1. ì‚¬ìš©ì ê´€ë¦¬**
  * **POST /api/users**: ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë“±ë¡í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ëŠ” API. ìƒˆ ì‚¬ìš©ì ë“±ë¡ì´ë‚˜ ê¸°ì¡´ ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • ì‹œ ì‚¬ìš©ë˜ê³  ìš”ì²­ ë³¸ë¬¸ì—ëŠ” ì‚¬ìš©ì ê´€ë ¨ ì •ë³´(ì´ë¦„, ì´ë©”ì¼ ë“±)ë¥¼ í¬í•¨í•œë‹¤.
  * **POST /api/auth/login**: ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” API. ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ JWT(Json Web Token)ê°€ ë°œê¸‰ë˜ì–´ ì¸ì¦ì´ í•„ìš”í•œ ë‹¤ë¥¸ API ìš”ì²­ì— ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.
  * **POST /api/auth/logout**: í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì„¸ì…˜ì„ ì¢…ë£Œí•˜ê³  JWTë¥¼ ë¬´íš¨í™”í•˜ëŠ” API. ì‚¬ìš©ìëŠ” ë¡œê·¸ì•„ì›ƒ í›„ ì¸ì¦ëœ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ì—†ë‹¤.

**2. ì˜í™” ê´€ë¦¬**
  * **GET /api/movies/popular**: í˜„ì¬ ì¸ê¸° ìˆëŠ” ì˜í™” ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” API. ì˜í™”ì˜ ê¸°ë³¸ ì •ë³´(ì œëª©, í¬ìŠ¤í„°, ê°œìš” ë“±)ë¥¼ í¬í•¨í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ì¸ê¸° ì˜í™”ë¥¼ ì†Œê°œí•œë‹¤.
  * **GET /api/movies/latest**: ìµœì‹  ê°œë´‰ëœ ì˜í™” ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” API. ìµœì‹  ì˜í™”ì˜ ì •ë³´ë¥¼ ì œê³µí•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ìµœì‹  ì˜í™” íŠ¸ë Œë“œë¥¼ ì†Œê°œí•œë‹¤.
  * **GET /api/movies/genre** : íŠ¹ì • ì¥ë¥´ì˜ ì˜í™” ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” API. ì‚¬ìš©ìê°€ ê´€ì‹¬ ìˆëŠ” ì¥ë¥´ë¥¼ ì„ íƒí•˜ë©´ í•´ë‹¹ ì¥ë¥´ì˜ ì˜í™” ëª©ë¡ì„ ì œê³µí•œë‹¤.
  * **GET /api/movies/search**: ì˜í™” ì œëª©ì´ë‚˜ ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜í™”ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” API. ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ì— ë§ëŠ” ì˜í™” ëª©ë¡ì„ ë°˜í™˜í•œë‹¤.
  * **GET /api/movies/** : íŠ¹ì • ì˜í™”ì˜ ìƒì„¸ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” API. ì˜í™” IDë¥¼ í†µí•´ ì˜í™”ì˜ ì„¸ë¶€ì‚¬í•­(ì œëª©, ê°œìš”, ê°ë…, ì¶œì—°ì§„ ë“±)ì„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
    
**3. ì¶”ì²œ ì‹œìŠ¤í…œ**
  * **POST /api/recommendations**: ì‚¬ìš©ìê°€ ì°œí•œ ì˜í™” ë° ì¦ê²¨ì°¾ê¸°í•œ ì˜í™”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§ì¶¤í˜• ì¶”ì²œ ì˜í™” ëª©ë¡ì„ ì œê³µí•˜ëŠ” API. ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ì‚¬ìš©ìì—ê²Œ ì í•©í•œ ì˜í™”ë¥¼ ì¶”ì²œí•œë‹¤.
  * **POST /api/recommendGenres/** : ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì¥ë¥´ ì„ í˜¸ë„ë¥¼ ë¶„ì„í•œ í›„ ê·¸ì— ë§ëŠ” ì¶”ì²œ ì˜í™” ëª©ë¡ì„ ì œê³µí•˜ëŠ” API. ì‚¬ìš©ìê°€ ì¢‹ì•„í•˜ëŠ” ì¥ë¥´ì— ë”°ë¼ ì˜í™”ë¥¼ ì¶”ì²œí•œë‹¤.
    
**4. ë¦¬ë·° ê´€ë¦¬**
  * **POST /api/reviews/add**: ì˜í™”ì— ëŒ€í•œ ì‚¬ìš©ìì˜ ë¦¬ë·°ë¥¼ ì¶”ê°€í•˜ëŠ” API. ì‚¬ìš©ìëŠ” ë¦¬ë·° ë‚´ìš©ì„ ì‘ì„±í•˜ê³  ì˜í™” IDì™€ í•¨ê»˜ ì œì¶œí•  ìˆ˜ ìˆë‹¤.
  * **GET /api/reviews/:title/:userId** : íŠ¹ì • ì˜í™”ì— ëŒ€í•´ ì‚¬ìš©ìê°€ ì‘ì„±í•œ ë¦¬ë·°ë¥¼ ì¡°íšŒí•˜ëŠ” API. ì˜í™” ì œëª©ê³¼ ì‚¬ìš©ì IDë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•´ë‹¹ ì‚¬ìš©ìì˜ ë¦¬ë·°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
  * **POST /api/reviews/update**: ê¸°ì¡´ì— ì‘ì„±í•œ ë¦¬ë·°ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” API. ë¦¬ë·° ë‚´ìš© ìˆ˜ì •ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©ëœë‹¤.
  * **DELETE /api/reviews/delete**: ì‘ì„±í•œ ë¦¬ë·°ë¥¼ ì‚­ì œí•˜ëŠ” API. ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë¦¬ë·°ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
    
**5. ë³´í˜¸ëœ ë¼ìš°íŠ¸**
  * **GET /api/protected**: ì¸ì¦ì´ í•„ìš”í•œ ë³´í˜¸ëœ ê²½ë¡œì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” API. ì´ ê²½ë¡œëŠ” ë¡œê·¸ì¸ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.


    
### ë¬¸ì œ í•´ê²°
ì˜í™” ë¦¬ë·° ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬í˜„í•˜ë©´ì„œ ë°œìƒí•œ ë¬¸ì œë“¤ê³¼ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë°©ë²•ë“¤ì„ ê¸°ìˆ í•´ë³´ë ¤ê³  í•œë‹¤.
* **ğŸŸ¥ë¬¸ì œ 1:**
```js
MongooseError: The uri parameter to openUri() must be a string, got "undefined". Make sure the first parameter to mongoose.connect() or mongoose.createConnection() is a string.
  method: 'get',
  url: 'https://api.themoviedb.org/3/movie/popular?api_key=undefined',
  data: undefined
  },
  data: {
  status_code: 7,
  status_message: 'Invalid API key: You must be granted a valid key.',
  success: false
}

```
  
ğŸ« **ë¬¸ì œ ë‚´ìš©**:MongoDB URLê³¼ TMDb API í‚¤ê°€ ì •ì˜ë˜ì§€ ì•Šì•„ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ê³¼ API ìš”ì²­ì´ ì‹¤íŒ¨í–ˆë‹¤. ì—ëŸ¬ ë©”ì‹œì§€ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
* MongoDB: URI íŒŒë¼ë¯¸í„°ê°€ ì •ì˜ë˜ì§€ ì•Šì•„ ì—°ê²° ì‹¤íŒ¨
* TMDb API: ìœ íš¨í•˜ì§€ ì•Šì€ API í‚¤ë¡œ ìš”ì²­ ì‹¤íŒ¨

ğŸ« **í•´ê²° ë°©ë²•**:  
**1. .env íŒŒì¼ ìœ„ì¹˜ í™•ì¸**: .env íŒŒì¼ì€ í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜í•˜ê³  ìˆê³ , fetchAndStoreMovies.js íŒŒì¼ì€ service í´ë” ë‚´ì— ìˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ `dotenv` íŒ¨í‚¤ì§€ëŠ” í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ .env íŒŒì¼ì„ ì°¾ê¸° ë•Œë¬¸ì—, ì˜¬ë°”ë¥¸ ìœ„ì¹˜ë¥¼ ì§€ì •í•´ ì£¼ì–´ì•¼ í•œë‹¤.

**2. ê²½ë¡œ ìˆ˜ì •**: fetchAndStoreMovies.js íŒŒì¼ì—ì„œ .env íŒŒì¼ì„ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œí•˜ê¸° ìœ„í•´ `dotenv` íŒ¨í‚¤ì§€ì˜ `config` ë©”ì„œë“œì— ê²½ë¡œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •í–ˆë‹¤.
```js
require('dotenv').config({ path: '../.env' });
```
ì´ë ‡ê²Œ í•˜ë©´ service í´ë” ë‚´ì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ backend ë£¨íŠ¸ì— ìˆëŠ” .env íŒŒì¼ì„ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œí•  ìˆ˜ ìˆë‹¤.  

**3. ì¬ì‹¤í–‰ ë° ê²€ì¦**: ê²½ë¡œë¥¼ ìˆ˜ì •í•œ í›„, ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ MongoDBì— ì˜í™” ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì €ì¥ë˜ëŠ”ì§€ í™•ì¸í–ˆë‹¤. ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë˜ì—ˆê³ , ì—ëŸ¬ ì—†ì´ ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ì—ˆë‹¤.

ğŸ« **ê²°ë¡ ** : í™˜ê²½ ë³€ìˆ˜ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•˜ê³  ê²½ë¡œë¥¼ ì •í™•í•˜ê²Œ ì§€ì •í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.  
**ë¸”ë¡œê·¸ ì°¸ê³ ** : https://velog.io/@kimina/%EC%98%81%ED%99%94-%EB%A6%AC%EB%B7%B0-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%985-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EA%B5%AC%EC%B6%95-%EB%B0%8F-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B0%80%EC%A0%B8%EC%99%80%EC%84%9C-%EB%B3%B4%EC%97%AC%EC%A3%BC%EA%B8%B0



**ğŸŸ¥ë¬¸ì œ 2: ì¤‘ë³µëœ ë°ì´í„°ê°€ ìˆìŒ**  

ğŸ« **ë¬¸ì œ ë‚´ìš©**: ì¶”ì²œ ì‹œìŠ¤í…œì—ì„œ ì¤‘ë³µëœ ì˜í™”ê°€ í¬í•¨ë˜ëŠ” ë¬¸ì œë¥¼ ë°œê²¬í–ˆë‹¤. ì¶”ì²œ ëª©ë¡ì— ì¤‘ë³µëœ ì˜í™” ì œëª©ì´ í¬í•¨ë˜ì–´ ì‚¬ìš©ìì—ê²Œ ë¹„íš¨ìœ¨ì ì¸ ì •ë³´ë¥¼ ì œê³µí•˜ê³  ìˆì—ˆë‹¤. ê¸°ì¡´ ì½”ë“œì—ì„œëŠ” ì¶”ì²œ ëª©ë¡ì´ ìœ ì‚¬ë„ì— ë”°ë¼ ì •ë ¬ë˜ì—ˆì§€ë§Œ, ì¤‘ë³µëœ ì˜í™” ì œëª©ì´ í¬í•¨ëœ ìƒíƒœë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜í–ˆë‹¤. ì´ë¡œ ì¸í•´ ì‚¬ìš©ìì—ê²Œ ë™ì¼í•œ ì˜í™”ê°€ ì—¬ëŸ¬ ë²ˆ ë‚˜íƒ€ë‚˜ë©°, ì¶”ì²œ ì‹œìŠ¤í…œì˜ ìœ ìš©ì„±ì´ ê°ì†Œí–ˆë‹¤.

ğŸ« **í•´ê²° ë°©ë²• : ì¤‘ë³µ ì œê±° ë° ìœ ì‚¬ë„ ê¸°ë°˜ ì •ë ¬**  
ì¶”ì²œ ëª©ë¡ì—ì„œ ì¤‘ë³µëœ ì˜í™” ì œëª©ì„ ì œê±°í•˜ê³ , ìœ ì‚¬ë„ì— ë”°ë¼ ì •ë ¬í•˜ì—¬ ìµœì ì˜ ì¶”ì²œ ëª©ë¡ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì ìš©í–ˆë‹¤.
```js
const recommendations = allMovies.map(movie => {
    const movieGenres = movie.genres || [];
    const movieVector = createUserGenreVector(movieGenres, genreMap, false);
    const similarity = cosineSimilarity(userVector, movieVector);
    
    return { movie, similarity };
  });

const movieMap = new Map();
recommendations.forEach(item => {
    const title = item.movie.title;
    if (!movieMap.has(title) || movieMap.get(title).similarity < item.similarity) {
      movieMap.set(title, item); 
    }
});

const uniqueRecommendations = Array.from(movieMap.values())
    .sort((a, b) => b.similarity - a.similarity);
  
res.json(uniqueRecommendations);
```
* **ì¤‘ë³µ ì œê±°ë¥¼ ìœ„í•œ ì²˜ë¦¬** : `Map` ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ ì¤‘ë³µëœ ì˜í™” ì œëª©ì„ ì œê±°í•˜ê³ , ìœ ì‚¬ë„ê°€ ë†’ì€ í•­ëª©ë§Œ ë‚¨ê¸°ë„ë¡ ìˆ˜ì •í–ˆë‹¤.
* **ì¤‘ë³µ ì œê±° í›„ ë°°ì—´ ìƒì„±** : `Array.from`ê³¼ `sort`ë¥¼ ì‚¬ìš©í•´ì„œ ì¤‘ë³µì„ ì œê±°í•˜ê³  ìœ ì‚¬ë„ì— ë”°ë¼ ì •ë ¬ëœ ì¶”ì²œ ëª©ë¡ì„ ìƒì„±í–ˆë‹¤.


**ğŸŸ¥ë¬¸ì œ 3: ì˜í™” ì¶”ì²œ ì‹œìŠ¤í…œì˜ ID ì¼ê´€ì„± ë¬¸ì œ**  

ğŸ« **ë¬¸ì œ ë‚´ìš©**: ì¶”ì²œ ì˜í™”ì˜ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™í•  ë•Œ ì˜í™”ì˜ IDê°€ ì¼ê´€ë˜ì§€ ì•Šì•„ í•´ë‹¹ ì˜í™”ì˜ ì •ë³´ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ì—†ì—ˆë‹¤. ë¬¸ì œì˜ ì›ì¸ì€ ì¶”ì²œ ì˜í™”ì™€ ì¥ë¥´ë³„ ì¶”ì²œ ì˜í™”ê°€ TMDB ì „ì²´ ì˜í™” ë°ì´í„°ì—ì„œ ì¶”ì¶œëœ ë°ì´í„°ì˜ IDë¥¼ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´, ê¸°ì¡´ì˜ ìµœì‹  ì˜í™”ì™€ ì¸ê¸° ì˜í™” ë°ì´í„°ëŠ” ë‹¤ë¥¸ ID ì²´ê³„ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì´ë¡œ ì¸í•´, ID ê¸°ë°˜ìœ¼ë¡œ ì •ë³´ë¥¼ ì¡°íšŒí•  ë•Œ ì¼ê´€ë˜ì§€ ì•ŠëŠ” IDë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.

ğŸ« **í•´ê²° ë°©ë²• : ì œëª© ê¸°ë°˜ ID ì¼ê´€ì„± ìœ ì§€** 
ì œëª©ì´ ë™ì¼í•œ ì˜í™”ë“¤ì— ëŒ€í•´ IDë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•˜ê¸° ìœ„í•´, ì¸ê¸° ì˜í™”, ìµœì‹  ì˜í™”, ì¥ë¥´ë³„ ì˜í™” ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ì¼ê´€ëœ IDë¥¼ í• ë‹¹í–ˆë‹¤.
```js
const { PopularMovie, LatestMovie, GenreMovie, Movies } = require('../models/Movie');

router.post('/:userId', async (req, res) => {
  const likedGenres = likedMovies.flatMap(movie => movie.genres);
  const bookmarkedGenres = bookmarkedMovies.flatMap(movie => movie.genres);

  const allMovies = await Movies.find();
  const [popularMovies, genreMovies, latestMovies] = await Promise.all([
    PopularMovie.find(),
    LatestMovie.find(),
    GenreMovie.find()
  ]);

  const recommendations = allMovies.map(movie => {
    const movieGenres = movie.genres || [];
    const movieVector = createUserGenreVector(movieGenres, genreMap, false);
    const similarity = cosineSimilarity(userVector, movieVector);

    const matchingMovie = popularMovies.find(m => m.title === movie.title) ||
      genreMovies.find(m => m.title === movie.title) ||
      latestMovies.find(m => m.title === movie.title);

    const movieId = matchingMovie && matchingMovie.id ? matchingMovie.id : movie._id;

    return { ...movie, movieId: movieId, similarity };
  }).filter(movie => movie !== null);

  res.json(recommendations);
});
```
* **ì˜í™” ì œëª©ì„ ê¸°ì¤€ìœ¼ë¡œ ID ë§¤ì¹­** : ì œëª©ì´ ë™ì¼í•œ ì˜í™”ì˜ IDë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•˜ê¸° ìœ„í•´, ì¸ê¸° ì˜í™”, ì¥ë¥´ë³„ ì˜í™”, ìµœì‹  ì˜í™” ë°ì´í„°ì—ì„œ ë§¤ì¹­ë˜ëŠ” ì˜í™”ë¥¼ ì°¾ê³  IDë¥¼ ì„¤ì •í–ˆë‹¤.
* **ID ì„¤ì •** : ë§¤ì¹­ëœ ì˜í™”ì˜ IDë¡œ ë®ì–´ì“°ê±°ë‚˜, ì—†ìœ¼ë©´ ê¸°ì¡´ì˜ _idë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ê´€ëœ IDë¥¼ ìœ ì§€í–ˆë‹¤.


ğŸ« **ê²°ë¡ **: ì¤‘ë³µëœ ì˜í™” ë°ì´í„°ë¥¼ ì œê±°í•˜ê³  ìœ ì‚¬ë„ì— ë”°ë¼ ì •ë ¬í•¨ìœ¼ë¡œì¨ ì‚¬ìš©ìì—ê²Œ ë” ì •í™•í•˜ê³  ìœ ìš©í•œ ì¶”ì²œ ëª©ë¡ì„ ì œê³µí•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ ê²°ê³¼ ì¶”ì²œ ì‹œìŠ¤í…œì˜ íš¨ìœ¨ì„±ê³¼ ì‚¬ìš©ì ê²½í—˜ì´ í–¥ìƒë˜ì—ˆë‹¤. ë˜í•œ, ì œëª©ì„ ê¸°ì¤€ìœ¼ë¡œ IDë¥¼ ì¼ê´€ë˜ê²Œ ì„¤ì •í•¨ìœ¼ë¡œì¨ ì˜í™” ì •ë³´ ì¡°íšŒ ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ID ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ í•´ê²°í–ˆë‹¤. ì´ë¡œ í†µí•´ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ì •í™•í•œ ì •ë³´ë¥¼ ì œê³µí•  ìˆ˜ ìˆì—ˆë‹¤.  
**ë¸”ë¡œê·¸ ì°¸ê³ ** : [https://velog.io/@kimina/%EC%98%81%ED%99%94-%EB%A6%AC%EB%B7%B0-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%9814-%EC%9C%A0%EC%82%AC%EB%8F%84-%EA%B3%84%EC%82%B0%ED%95%B4%EC%84%9C-%EC%98%81%ED%99%94-%EC%B6%94%EC%B2%9C2](https://velog.io/@kimina/%EC%98%81%ED%99%94-%EB%A6%AC%EB%B7%B0-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%9814-%EC%9C%A0%EC%82%AC%EB%8F%84-%EA%B3%84%EC%82%B0%ED%95%B4%EC%84%9C-%EC%98%81%ED%99%94-%EC%B6%94%EC%B2%9C2)


**ğŸŸ¥ë¬¸ì œ 4: JWT ë§Œë£Œ ë¬¸ì œ**  

ğŸ« **ë¬¸ì œ ë‚´ìš©**: JWT í† í°ì„ ì‚¬ìš©í•´ì„œ êµ¬ê¸€ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³  ìˆë‹¤. JWT ë§Œë£Œ ê¸°í•œì„ 1ì‹œê°„ìœ¼ë¡œ ì„¤ì •í•´ë‘ì—ˆìœ¼ë‚˜, ì´ë¡œ ì¸í•´ 1ì‹œê°„ë§ˆë‹¤ í† í° ì„¸ì…˜ì´ ë§Œë£Œë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë§Œë£Œ ê¸°ê°„ì„ `{ expiresIn: '1y' }`ë¡œ ë³€ê²½í•˜ì—¬ JWT í† í°ì˜ ìœ íš¨ ê¸°ê°„ì„ 1ë…„ìœ¼ë¡œ ì„¤ì •í–ˆì§€ë§Œ ì•„ë˜ì™€ ê°™ì€ ì´ìœ ë¡œ ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸°ë¡œ ê²°ì •í–ˆë‹¤.
 * **ë³´ì•ˆ ìœ„í—˜ ì¦ê°€:** ë§Œë£Œ ì‹œê°„ì„ ê¸¸ê²Œ ì„¤ì •í•˜ë©´ í† í°ì´ ë…¸ì¶œë˜ì—ˆì„ ë•Œì˜ ë³´ì•ˆ ìœ„í—˜ì´ ì»¤ì§„ë‹¤.
 * **ì‚¬ìš©ì ê²½í—˜ ì €í•˜:** ì§§ì€ ë§Œë£Œ ì‹œê°„ì€ ì‚¬ìš©ìê°€ ìì£¼ ë¡œê·¸ì¸ì„ í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ê²½í—˜ì´ ë‚˜ë¹ ì§ˆ ìˆ˜ ìˆë‹¤.
   
ë”°ë¼ì„œ ë³´ì•ˆìƒê³¼ ì‚¬ìš©ì ê²½í—˜ì„ ëª¨ë‘ ê³ ë ¤í•˜ì—¬ í† í°ì˜ ìœ íš¨ ê¸°ê°„ì„ ì§§ê²Œ ì„¤ì •í•˜ë˜, ìë™ìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆë‹¤. ì´ë¥¼ ìœ„í•´ **Access Token**ê³¼ **Refresh Token**ì„ ì¡°í•©í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•  ê³„íšì´ë‹¤.
ë™ì‘ ê³¼ì •ì€ ë¡œê·¸ì¸ í›„, ì‚¬ìš©ìëŠ” Access Tokenì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ëœ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³ , Access Tokenì´ ë§Œë£Œë˜ë©´ /refresh ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ìƒˆë¡œìš´ Access Tokenì„ ë°œê¸‰ë°›ì•„ ì‚¬ìš©ì ì¸ì¦ì— ì‚¬ìš©í•˜ëŠ” íë¦„ì´ë‹¤.

ğŸ« **í•´ê²° ê³¼ì •**  
**1. Access Tokenê³¼ Refresh Token ìƒì„± ë° ë¡œê·¸ì¸ ì²˜ë¦¬**
```js
// JWT ìƒì„± í•¨ìˆ˜(access token)
function generateAccessToken(user) {
  return jwt.sign({ id: user.uid, email: user.email }, secret, { expiresIn: '15m' }); 
}

// JWT ìƒì„± í•¨ìˆ˜(refresh token)
function generateRefreshToken(user) {
  return jwt.sign({ id: user.uid, email: user.email }, refreshSecret, { expiresIn: '7d' }); 
}
```
* ë¡œê·¸ì¸ ì‹œ, ì‚¬ìš©ìëŠ” access tokenê³¼ refresh tokenì„ ë°œê¸‰ë°›ëŠ”ë‹¤.
* access tokenì€ ì§§ì€ ìœ íš¨ê¸°ê°„ì„ ê°€ì§€ë©°, refresh tokenì€ ìƒëŒ€ì ìœ¼ë¡œ ê¸´ ìœ íš¨ ê¸°ê°„ì„ ê°€ì§„ë‹¤.

  
**ë¡œê·¸ì¸ (`/login`)**  
ë¡œê·¸ì¸ í›„, Access Tokenê³¼ Refresh Tokenì€ ì¿ í‚¤ì— ì €ì¥ë˜ë©°, í´ë¼ì´ì–¸íŠ¸ëŠ” ì´í›„ ìš”ì²­ì—ì„œ ì´ í† í°ë“¤ì„ ì‚¬ìš©í•œë‹¤.

```js
router.post('/login', (req, res) => {
  const user = req.body;
  const accessToken = generateAccessToken(user);
  const refreshToken = generateRefreshToken(user);

  res.cookie('accessToken', accessToken, {
    httpOnly: true,
    secure: false,  
    sameSite: 'lax'   
  });
  res.cookie('refreshToken', refreshToken, {
    httpOnly: true,
    secure: false,  
    sameSite: 'lax'   
  });

  res.status(200).json({ message: 'Logged in successfully', accessToken, refreshToken }); 
});
```
* Access Tokenê³¼ Refresh Tokenì€ httpOnly ë° secure ì†ì„±ì´ ì„¤ì •ëœ ì¿ í‚¤ì— ì €ì¥í•˜ì—¬ XSS(Cross-Site Scripting) ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•  ìˆ˜ ìˆë‹¤.
* httpOnlyëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í† í°ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ í•˜ê³ , secureëŠ” HTTPSë¥¼ í†µí•´ì„œë§Œ ì¿ í‚¤ê°€ ì „ì†¡ë˜ë„ë¡ ë³´ì¥í•œë‹¤.


ğŸ« **2. ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬**
**ë¡œê·¸ì•„ì›ƒ (`/logout`)**  
ë¡œê·¸ì•„ì›ƒ ì‹œì—ëŠ” ì¿ í‚¤ì— ì €ì¥ëœ Access Tokenê³¼ Refresh Tokenì„ ì‚­ì œí•˜ì—¬ ì„œë²„ì—ì„œ ì¸ì¦ ìƒíƒœë¥¼ ì¢…ë£Œí•œë‹¤.
```js
router.post('/logout', (req, res) => {
  try {
    res.clearCookie('accessToken', { ... });
    res.clearCookie('refreshToken', { ... });
    res.status(200).json({ message: 'Logged out successfully' });
  } catch (error) {
    res.status(500).json({ message: 'Logout failed', error: error.message });
  }
});
```

ğŸ« **3. Access Token ê°±ì‹  ì²˜ë¦¬**  
Access Tokenì´ ë§Œë£Œë˜ë©´, í´ë¼ì´ì–¸íŠ¸ëŠ” ì €ì¥ëœ Refresh Tokenì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ Access Tokenì„ ìš”ì²­í•œë‹¤. ì„œë²„ëŠ” Refresh Tokenì„ ê²€ì¦í•œ í›„ ìƒˆë¡œìš´ Access Tokenì„ ë°œê¸‰í•œë‹¤.  
**í† í° ê°±ì‹  ì—”ë“œí¬ì¸íŠ¸ (/refresh)**
```js
router.post('/refresh', (req, res) => {
  const { refreshToken } = req.cookies;

  jwt.verify(refreshToken, refreshSecret, (err, user) => {
    if (err) {
      return res.status(403).json({ message: 'Invalid refresh token' });
    }
    const newAccessToken = generateAccessToken(user);
    res.cookie('accessToken', newAccessToken, { ... });
    res.status(200).json({ message: 'Access token refreshed', accessToken: newAccessToken, refreshToken: refreshToken });
  })
})
```
ğŸ« **4. Vuex ìŠ¤í† ì–´ì—ì„œì˜ ì‚¬ìš© ì˜ˆì œ**  
Vuex ìŠ¤í† ì–´ì—ì„œëŠ” refreshToken ì•¡ì…˜ì„ í†µí•´ í† í° ê°±ì‹ ì„ ì²˜ë¦¬í•˜ë©°, ë§Œë£Œëœ Access Tokenì„ ìƒˆë¡œìš´ ê²ƒìœ¼ë¡œ êµì²´í•œë‹¤.
```js
async refreshToken({ commit, state }) {
      try {
        const response = await axios.post('http://localhost:5000/api/auth/refresh', {
          refreshToken: state.refreshToken
        });

        const { accessToken, refreshToken } = response.data; // ì„œë²„ì—ì„œ ìƒˆ access tokenê³¼ refresh tokenì„ ë°›ì•„ì˜´

        commit('setToken', accessToken);
        commit('setRefreshToken', refreshToken);

        axios.defaults.headers.common["Authorization"] = `Bearer ${accessToken}`;
      } catch (error) {
        throw error;
      }
    },
    async logout({ commit }) {
      await axios.post('http://localhost:5000/api/auth/logout');
      commit('logout');
      delete axios.defaults.headers.common['Authorization'];
    }
  },
```

ğŸ« **ê²°ë¡ ** : ì´ ì ‘ê·¼ ë°©ì‹ì€ JSON Web Tokens (JWT)ì™€ Refresh Tokensë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì¸ì¦ì„ ì²˜ë¦¬í•œë‹¤. JWTëŠ” ì§§ì€ ìœ íš¨ ê¸°ê°„ì„ ê°€ì§€ê³  ìˆì–´ ë³´ì•ˆì„±ì„ ê°•í™”í•˜ë©°, Refresh Tokenì„ í†µí•´ ì„¸ì…˜ì„ ì—°ì¥í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¨ë‹¤. ì´ë¡œì¨ ë³´ì•ˆê³¼ ì‚¬ìš©ì í¸ì˜ì„±ì„ ëª¨ë‘ ì¶©ì¡±í•  ìˆ˜ ìˆëŠ” ì¸ì¦ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆì—ˆë‹¤.  
**ë¸”ë¡œê·¸ ì°¸ê³ ** : https://velog.io/@kimina/%EC%98%81%ED%99%94-%EB%A6%AC%EB%B7%B0-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%9815-%EC%82%AC%EC%9A%A9%EC%9E%90-jwt-%ED%86%A0%ED%81%B0-%EC%84%B8%EC%85%98-%EB%A7%8C%EB%A3%8C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0


### ì‚¬ìš© ë°©ë²•
ğŸ¥² **1. í™˜ê²½ ì„¤ì •**
* í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— .env íŒŒì¼ì„ ìƒì„±í•˜ê³ , ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
  ```
    TMDB_API_KEY=your_tmdb_api_key
    JWT_SECRET=your_jwt_secret
    PORT=5000
  ```
ğŸ¥² **2. ì˜ì¡´ì„± ì„¤ì¹˜**
* í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤
  ```
    npm install
  ```
ğŸ¥² **3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°**
MongoDBì™€ì˜ ì—°ê²°ì„ ìœ„í•´ config/mongoose.js íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ URIë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

ğŸ¥² **4. ì„œë²„ ì‹¤í–‰**
  ```
    node app.js
  ```
ğŸ¥² **5. ë°ì´í„° ê°€ì ¸ì˜¤ê¸°**
ì˜í™” ë°ì´í„°ë¥¼ TMDB APIì—ì„œ ê°€ì ¸ì™€ MongoDBì— ì €ì¥í•˜ë ¤ë©´ service/fetchAndStoreMovies.js íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤
```
  node service/fetchAndStoreMovies.js
```
